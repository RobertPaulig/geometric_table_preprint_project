% geometric_table_snowflakes_preprint.tex
% Title: Geometric Table Snowflakes: Divisibility Geometry, Primitive Factor Graphs, and Spectral Fingerprints of Integers
% Compile: latexmk -lualatex -interaction=nonstopmode geometric_table_snowflakes_preprint.tex
\documentclass[11pt]{article}

% ----- Packages -----
\usepackage{iftex}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath, amssymb, amsthm, mathtools}
\usepackage{bm}
\usepackage{microtype}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{enumitem}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{algorithm}
\usepackage{algpseudocode}

% ----- Fonts (LuaLaTeX/XeLaTeX) -----
\ifPDFTeX
  % pdfLaTeX fallback (kept for compatibility)
\else
  \usepackage{fontspec}
  \setmainfont{Latin Modern Roman}
  \setsansfont{Latin Modern Sans}
  \setmonofont{Latin Modern Mono}
\fi

% ----- Hyperref -----
\hypersetup{
  colorlinks=true,
  linkcolor=blue,
  citecolor=blue,
  urlcolor=blue
}

% ----- Theorem environments -----
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}

% ----- Macros -----
\newcommand{\GT}{\mathrm{GT}}
\newcommand{\lcm}{\mathrm{lcm}}
\renewcommand{\gcd}{\mathrm{gcd}}
\newcommand{\1}{\mathbf{1}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Q}{\mathbb{Q}}

\title{\bfseries Geometric Table Snowflakes: Divisibility Geometry, Primitive Factor Graphs, and Spectral Fingerprints of Integers}
\author{Robert Paulig\\
\small (working draft; contact: \texttt{btc.paulig@gmail.com})}
\date{\today}

\begin{document}
\maketitle

\begin{abstract}
We introduce the \emph{Geometric Table}: a sparse divisibility matrix whose non-empty cells encode factor pairs and induce a geometry of rational rays on the integer lattice. From local windows of the table we build \emph{primitive factor graphs} and study their Laplacian spectra as reproducible fingerprints of integer structure. We connect (i) diagonal ``ray algebra'' around a node $N$ to the divisor sets $d\pm 1$; (ii) a bipartite graph model (numbers $\leftrightarrow$ rays) filtered by primitive factor pairs; and (iii) a reproducible computational protocol (``evidence packs'') for spectral comparisons of classes of centers.
\end{abstract}

\tableofcontents

\section{Introduction}
This draft studies a single object --- the Geometric Table --- from three synchronized perspectives: (a) geometry of rays, (b) graphs induced by factor pairs, and (c) spectral invariants. The immediate goal is a reproducible computational framework; the long-term goal is to test whether spectral signatures correlate with prime-structure events (e.g., centers of twin primes).

\paragraph{Snowflakes.}
We call an even integer $N$ a \emph{full snowflake} if $N-1$ and $N+1$ are prime (equivalently, $N$ is the midpoint of a twin-prime pair). Proving infinitely many full snowflakes is equivalent to the Twin Prime Conjecture; nevertheless, our framework supports \emph{partial} snowflakes (sieve-level conditions) that are provably infinite via CRT and may still exhibit distinctive spectral structure.

\section{Geometric Table}
\subsection{Divisibility matrix and support}
Fix window parameters $(N_{\max},K)$. Define
\begin{equation}
T_{N_{\max},K}(n,k)=
\begin{cases}
\frac{n}{k}, & k\mid n,\\
\varnothing, & \text{otherwise},
\end{cases}
\qquad 1\le n\le N_{\max},\ 1\le k\le K.
\end{equation}
Its binary support is $B(n,k)=\1_{\{k\mid n\}}$.

\subsection{Rays and angles}
For a fixed quotient $q\in\N$, the set of lattice points with $T(n,k)=q$ satisfies $n=qk$, i.e.\ a ray from the origin with slope $q$. Define the ray angle
\begin{equation}
\theta(q)=\arctan(q)\in (0,\pi/2).
\end{equation}

\subsection{Primitive cells}
The usual lattice visibility $\gcd(n,k)=1$ trivializes under $k\mid n$. Instead we define \emph{primitive factor cells} by
\begin{equation}
B^{\mathrm{prim}}(n,k)=\1_{\{k\mid n,\ \gcd(k,n/k)=1\}}.
\end{equation}
This retains only factor pairs with no shared prime factors.

\section{Diagonal ray algebra around a node $N$}
Fix an integer $N$ (the ``node''). Consider the diagonals $n+k=N$ and $n-k=N$.

\begin{proposition}[Diagonal characterization]
Let $k\in\N$. Then the cell on the diagonal $n+k=N$ is non-empty if and only if $k\mid N$, and in that case
\[
T(N-k,k)=\frac{N}{k}-1.
\]
Similarly, the cell on the diagonal $n-k=N$ is non-empty if and only if $k\mid N$, and in that case
\[
T(N+k,k)=\frac{N}{k}+1.
\]
\end{proposition}

Define the diagonal spectra
\begin{equation}
S^-(N)=\{d-1:\ d\mid N\},\qquad S^+(N)=\{d+1:\ d\mid N\}.
\end{equation}
Primes observed on the diagonals correspond to divisibility constraints: $p\in S^-(N)$ iff $(p+1)\mid N$; $p\in S^+(N)$ iff $(p-1)\mid N$.

\section{Primitive Geometric Table Graph}
\subsection{Windowed bipartite graph}
Fix a center $N_0$, window half-height $h$, and width $K$. Let
\[
I=[N_0-h,N_0+h]\cap \N.
\]
Define a bipartite graph $G=(U\sqcup V,E,w)$:
\begin{align}
U&=I \quad \text{(rows / integers)},\\
V&=\{q\in\N:\ \exists n\in I,\ \exists k\le K \text{ with } n=kq\},\\
E&=\{(n,q): n\in I,\ \exists k\le K: n=kq,\ \gcd(k,q)=1\}.
\end{align}
Weights can be chosen as $w(n,q)=1$ (unweighted), or geometrically by $w(n,q)=\theta(q)=\arctan(q)$, or scale-weighted by $w(n,q)=\log q$.

\subsection{Adjacency, Laplacian, and spectrum}
Let $A$ be the (weighted) adjacency matrix on $U\cup V$, $D$ its degree matrix, and $L=D-A$ the Laplacian. We typically compare normalized Laplacians
\[
L_{\mathrm{norm}}=I-D^{-1/2}AD^{-1/2}.
\]
We define the \emph{spectral fingerprint} of a window by a vector of low-frequency eigenvalues
\[
\bm{\lambda}_r(N_0;h,K)=\bigl(\lambda_1,\ldots,\lambda_r\bigr),
\]
together with summary features (spectral gap, entropy, localization measures).

\section{Snowflakes and ``full rays''}
\subsection{Partial snowflakes via sieve constraints}
For $K\ge 2$, define the \emph{partial snowflake condition}
\begin{equation}
FS_K(N):\quad \forall p\le K\ (p \text{ prime}),\quad N\not\equiv \pm 1 \pmod p.
\end{equation}
This is equivalent to requiring $p\nmid (N-1)$ and $p\nmid(N+1)$ for all primes $p\le K$.

\begin{theorem}[CRT infinitude of partial snowflakes]
For each fixed $K\ge 2$, the set of $N$ satisfying $FS_K(N)$ is infinite and is a union of residue classes modulo $Q_K=\prod_{p\le K}p$.
\end{theorem}

\subsection{Full snowflakes (twin-prime centers)}
Define \emph{full snowflakes} by the scale-coupled condition
\[
FS_\ast(N):\quad \forall p\le \sqrt{N+1}\ (p \text{ prime}),\quad N\not\equiv \pm 1 \pmod p.
\]
\begin{theorem}[Full snowflakes $\Leftrightarrow$ twin primes]
For even $N$, $FS_\ast(N)$ holds if and only if $N-1$ and $N+1$ are prime.
\end{theorem}

\section{Experimental protocol and reproducibility}
\subsection{Default parameters}
Default experimental parameters:
\[
h=200,\qquad K=200,
\]
and two weight modes: $w\equiv 1$ and $w(n,q)=\arctan(q)$.

\subsection{Outputs (Evidence Pack)}
Each run produces:
\begin{itemize}[leftmargin=2em]
  \item \texttt{params.json} (window, weights, filters);
  \item \texttt{nodes.json} (vertex maps);
  \item \texttt{edges.csv} (edge list);
  \item \texttt{eigenvalues.json} and \texttt{metrics.json};
  \item \texttt{checksums.sha256} over all artifacts.
\end{itemize}

\section{Discussion and open problems}
We propose studying whether spectral features reliably discriminate: (i) highly composite nodes, (ii) partial snowflakes $FS_K$ with large $K$, and (iii) full snowflakes (twin-prime centers). Proving infinitely many full snowflakes is equivalent to the Twin Prime Conjecture; nonetheless, the Geometric Table framework may expose new invariants and heuristics for ``ray stability'' and factor-geometry.

\section{Empirical Results}
\subsection{Setup}
We use windows with $h=200$, $K=200$, primitive filtering, and a fixed RNG seed.
The core window uses $r=30$ around the center. We report results for $w\equiv 1$
and the IDF weight. Centers are sampled uniformly from $[500,1500]$.
Main figures and tables are shown for $w\equiv 1$; IDF variants are listed in
the Appendix.

\subsection{Giant Component Spectra}
Normalized Laplacian spectra on the full graph contain many zeros, matching the
number of connected components. We therefore compute spectral summaries on the
giant component (GC), where $\lambda_2$ and entropy reflect structure rather than
disconnectedness.

\paragraph{Windows as a translation-invariant feature extractor.}
For a center $N_0$, we define a finite observation window of the Geometric Table
by restricting rows to $n\in[N_0-h,N_0+h]$ and columns to divisors $k\le K$.
This induces a deterministic feature map $F_{h,K,r}(N_0)$ (via the core subwindow $r$ and the corresponding
row-projection graph spectrum). With fixed $(h,K,r)$, repeated motifs across centers are expected:
they represent baseline modular structure of divisibility under a fixed “lens”.
Our analysis therefore focuses on \emph{deviations} from this baseline within controlled residue classes
(e.g.\ $N_0\equiv 0\pmod 6$ for twin-center candidates) and on the persistence of such deviations across scales.
To avoid degeneracy of the induced core graph at large centers, we initialize $K_0\propto\sqrt{N_0}$ and adaptively increase it until the core giant component reaches a minimal size; the effective $K$ is logged and included as a covariate.
These features are intentionally local: they respond to the absence of small divisors in the specific rows $(c\pm 1)$ and therefore constitute a geometric signature of primality within the chosen window, not a proof of infinitude.

\subsection{Twin-Center Effect in the Core Window}
We compare twin-centers (both $N\pm 1$ prime) against non-twins using core-window
GC metrics. The group summaries are in Table~\ref{tab:group-stats}.

\begin{table}[h]
\centering
\input{out/latex_table_groups_ones.tex}
\caption{Group statistics for core-window GC metrics (weight: ones).}
\label{tab:group-stats}
\end{table}

\subsection{Controlling for Composite Density}
We regress core GC gap against twin label, core edges, and GC fraction to control
for composite-density confounds. Figure~\ref{fig:core-gap-scatter} shows the
core-gap vs core-edges relationship, with highlighted centers.

\begin{figure}[h]
\centering
\includegraphics[width=0.75\linewidth]{fig/core_gap_scatter_edges.png}
\caption{Core gap vs core edges (twins vs non-twins; highlighted centers).}
\label{fig:core-gap-scatter}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.7\linewidth]{fig/core_gap_box_twins_ones.png}
\caption{Core GC gap: twins vs non-twins.}
\label{fig:core-gap-box}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.7\linewidth]{fig/core_entropy_box_twins_ones.png}
\caption{Core GC entropy: twins vs non-twins.}
\label{fig:core-entropy-box}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.7\linewidth]{fig/core_gap_hist_ones.png}
\caption{Core GC gap distribution with highlighted centers.}
\label{fig:core-gap-hist}
\end{figure}

\paragraph{Disclaimer.}
These results are empirical; they do not prove infinitude of twin primes nor
circumvent known theoretical barriers. Global GC metrics (gap, entropy) do not
separate twin centers under mod-6 control and scale-adaptive windows, while local twin-row
features act as geometric signatures of primality within the chosen window.

\subsection{Mod-6 Controlled Analysis (Centers $c\equiv 0 \pmod 6$)}
Twin-prime centers are almost always divisible by $6$, so we repeat the batch
analysis restricted to $c\equiv 0 \pmod 6$ to remove this confounder. We also
report matched-pair comparisons within this class (twin vs nearest non-twin by
core-edge count) to isolate the twin effect at fixed composite density.

\paragraph{Global GC metrics (negative result).}
On the six-only batch with hybrid $K$ (scale-adaptive), $M=2000$, survival $\approx 0.84$, the regression
of core GC gap on twin label, core edges, core GC fraction, and $\log K_{\text{used}}$ yields $\beta_{\text{twin}}\approx 0$ with permutation
$p\approx 0.54$; matched-pairs mean/median $\Delta$ gap $\approx 0$. Thus GC gap is not a stable marker of twin centers once scale and mod-6 are controlled.

\paragraph{Local twin-row signatures (positive result).}
Adding local features for the rows $c\pm 1$ shows a strong effect: twin isolates
($\text{twin\_isolates}$) $\beta_{\text{twin}}\approx 0.41$ (perm-$p\approx 2\times 10^{-4}$),
and twin degree sum ($\text{twin\_deg\_sum}$) $\beta_{\text{twin}}\approx -0.88$ (perm-$p\approx 2\times 10^{-4}$).
These are geometric signatures of the absence of small divisors in $c\pm 1$, not a proof of infinitude of twin primes.

\paragraph{Matched strictness.}
After strict matching (|$d|\le 200$, $\Delta\log K\le 0.05$, edge and GC-fraction tolerances) we retain $n_{\text{raw}}=126$, $n_{\text{strict}}=123$ pairs with $\Delta$ edges in $[-7,0,7]$, confirming that the strict filter is tight without collapsing the sample.

\begin{table}[h]
\centering
\input{out/latex_table_groups_six_ones_core_autok.tex}
\caption{Group statistics for six-only batch (weight: ones, core-only, adaptive $K$).}
\end{table}

\begin{figure}[h]
\centering
\includegraphics[width=0.7\linewidth]{fig/core_gap_box_twins_six_ones_core_autok.png}
\caption{Six-only: core GC gap (twins vs non-twins, adaptive $K$).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.7\linewidth]{fig/matched_delta_gap_six_autok.png}
\caption{Matched pairs: $\Delta$ core gap (twin - control) for $c\equiv 0 \pmod 6$ (adaptive $K$).}
\end{figure}

\appendix
\section{IDF and Core-$r$ Variants}
IDF-weighted tables and figures are provided for comparison:
\input{out/latex_table_groups_idf.tex}
\begin{figure}[h]
\centering
\includegraphics[width=0.7\linewidth]{fig/core_gap_box_twins_idf.png}
\caption{Core GC gap: twins vs non-twins (IDF).}
\end{figure}
\begin{figure}[h]
\centering
\includegraphics[width=0.7\linewidth]{fig/core_entropy_box_twins_idf.png}
\caption{Core GC entropy: twins vs non-twins (IDF).}
\end{figure}

We also report robustness over $r\in\{20,30,40\}$ using batch summaries
in \texttt{out/analysis\_report\_core20.json}, \texttt{out/analysis\_report\_core30.json},
and \texttt{out/analysis\_report\_core40.json}.

\appendix
\section{Reproducibility commands}
Run batch and analysis (six-only, hybrid $K$) from the project root:
\begin{verbatim}
cd code
PYTHONPATH=. python scripts/batch_centers.py --center-min 500 --center-max 200000 \
  --M 2000 --center-set six --core-r 30 --primitive --weight ones --fast-core \
  --alpha 1.3 --growth 1.5 --max-bumps 6 --min-gc-size 10 --k-max 20000 \
  --out out/batch_summary_six_ones_core_autok.csv
PYTHONPATH=. python scripts/analyze_batch.py --input out/batch_summary_six_ones_core_autok.csv \
  --out-dir out --label six_ones_core_autok --permutation-iters 5000 --bootstrap-iters 1000
PYTHONPATH=. python scripts/matched_twins.py --center-min 500 --center-max 200000 \
  --core-r 30 --primitive --weight ones --alpha 1.3 --growth 1.5 --max-bumps 6 \
  --min-gc-size 10 --k-max 20000 --max-d 50 --max-d-strict 200 --delta-logK-tol 0.05 \
  --delta-edges-tol 10 --delta-edges-rel-tol 0.02 --delta-frac-tol 0.05 \
  --centers-csv out/batch_summary_six_ones_core_autok.csv --restrict-to-csv \
  --out-csv out/matched_pairs_six_core30_autok.csv --out-json out/matched_analysis_six_core30_autok.json
\end{verbatim}

\section{Reference algorithm (pseudocode)}
\begin{algorithm}[H]
\caption{Build primitive bipartite graph from a window}
\begin{algorithmic}[1]
\Require center $N_0$, half-height $h$, width $K$
\State $I \gets \{N_0-h,\dots,N_0+h\}\cap\N$
\State $U \gets I$, $V\gets \emptyset$, $E\gets \emptyset$
\For{$n \in I$}
  \For{$k \in \{1,\dots,K\}$}
    \If{$k \mid n$}
      \State $q \gets n/k$
      \If{$\gcd(k,q)=1$}
        \State add $q$ to $V$
        \State add edge $(n,q)$ to $E$
      \EndIf
    \EndIf
  \EndFor
\EndFor
\State \Return $(U,V,E)$
\end{algorithmic}
\end{algorithm}

\subsection{Primes as isolated rows in a bounded window}
For an integer $n$ and divisor cap $K$, define the quotient set
\[
Q_K(n)=\{n/k:\ k\mid n,\ k\le K,\ \gcd(k,n/k)=1\}.
\]
\begin{proposition}[Primes isolate when $K$ and the window are bounded]
Let $p$ be prime with $p>K$, and consider the row-projection graph on rows $n\in[p-h,p+h]$.
If $p>h$, then $Q_K(p)=\{p\}$ and no other row in the window shares this quotient.
Consequently the row for $p$ is isolated; for a twin-center $c=p+1$, the rows $c\pm 1$ typically isolate simultaneously.
\end{proposition}
\begin{proof}[Proof sketch]
Since $p$ is prime and $p>K$, every admissible divisor $k\le K$ equals $1$, so $Q_K(p)=\{p\}$.
A row $m$ connects to $p$ only if $m=p\cdot k$ with $k\le K$ and $m$ lies in the window.
If $p>h$, no multiple $2p,3p,\dots$ lies inside $[p-h,p+h]$, hence there is no shared quotient and the row $p$ has degree $0$.
Twin centers $c=p+1$ therefore induce low degree and high isolate counts on the rows $c\pm 1$ when $p,h,K$ fall in this regime.
\end{proof}

\bibliographystyle{plain}
% \bibliography{references}
\end{document}
