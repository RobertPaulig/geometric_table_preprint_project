\documentclass[11pt]{article}

\usepackage[margin=1in]{geometry}
\usepackage{amsmath, amssymb}
\usepackage{graphicx}
\usepackage{hyperref}

\title{Wave Atlas: Geometric Table Fronts (M1)}
\author{Working note}
\date{Wave Atlas v1.1}

\begin{document}
\maketitle

\section{Definitions}
Let $M(n,k)=\mathbf{1}_{\{k\mid n\}}$ be the occupancy matrix of the Geometric Table,
and $V(n,k)=n/k$ on cells where $k\mid n$ (empty otherwise). For a fixed diagonal
center $N$, define the diagonal profile
\[
D_N(k)=N/k-1,\qquad k\le K,\ k\mid N.
\]
We visualize three ``wave'' views: occupancy, log-values, and diagonal hits.

\section{Occupancy and values}
\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/divisibility_occ_N3000_K120.png}
\caption{Occupancy heatmap $M(n,k)$ for $N_{\max}=3000$, $K=120$.}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/divisibility_val_log_N3000_K120.png}
\caption{Log-values heatmap $\log(1+V(n,k))$ on occupied cells.}
\end{figure}

\paragraph{Scroll.}
The scroll animation is saved as
\texttt{out/wave\_atlas/divisibility\_occ\_scroll\_N3000\_K120\_H220\_step60.gif}.

\section{Diagonal profiles}
\begin{figure}[h]
\centering
\includegraphics[width=0.49\linewidth]{../out/wave_atlas/diagonal_hits_N60_K120.png}
\includegraphics[width=0.49\linewidth]{../out/wave_atlas/diagonal_hits_N420_K120.png}
\caption{Diagonal profiles for $N=60$ and $N=420$.}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.49\linewidth]{../out/wave_atlas/diagonal_hits_N2520_K120.png}
\includegraphics[width=0.49\linewidth]{../out/wave_atlas/diagonal_hits_N27720_K120.png}
\caption{Diagonal profiles for $N=2520$ and $N=27720$.}
\end{figure}

\section{Wave Metrics (M2)}
Wave patterns can be decomposed into three interacting structures: periodic combs
(column densities), rays $n=qk$ (counts by $q$), and diagonal impulses (divisor hits).

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/metrics/col_density_heatmap.png}
\caption{Column density heatmap across sliding windows (x=$k$, y=window start). Clear periodic combs appear at small $k$.}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/metrics/q_top_bars_win1.png}
\caption{Top $q$ counts in the first window (rays $n=qk$). Dominant $q$ values trace the most frequent rays.}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/metrics/diag_hits_raster_N2520_K120.png}
\caption{Diagonal hits raster for $N=2520$ (hit/non-hit over $k$). Impulses align with dense divisor blocks.}
\end{figure}

\section{Baselines and scaling (M3)}
Two deterministic baselines serve as controls. First, the expected occupancy density
over a window is $H_K/K$ where $H_K=\sum_{k\le K}1/k$, and the measured densities
match this baseline closely. Second, column densities follow the $1/k$ law.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/metrics/col_density_vs_1_over_k.png}
\caption{Mean column density versus the $1/k$ baseline. Deviations are small.}
\end{figure}

\begin{table}[h]
\centering
\begin{tabular}{lccc}
\hline
$K$ & $\overline{\text{occ}}$ & $H_K/K$ & $|\Delta|$ \\
\hline
60  & 0.07764 & 0.077998 & 0.000354 \\
120 & 0.04452 & 0.044741 & 0.000224 \\
240 & 0.02510 & 0.025250 & 0.000145 \\
\hline
\end{tabular}
\caption{Scaling check: measured occupancy density matches $H_K/K$.}
\end{table}

\paragraph{Ray-count identity.}
For each window and $q$, the observed ray count equals the exact formula
$\max(0, \min(K,\lfloor (a+H-1)/q\rfloor) - \lceil a/q\rceil + 1)$, confirming
that the $q$-structure is deterministic geometry rather than noise.

\section{M4 Wheel Overlay}
Wheel centers $N=t\cdot L_m$ fix a dense diagonal backbone from $L_m$ while $t$ modulates
local smoothness. We overlay wave-style features on these centers and compare twin
vs non-twin cases.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m4/m4_runlen_hist.png}
\caption{Diagonal run length ($K=120$) for wheel centers: twin vs non-twin.}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m4/m4_tdiv_hist.png}
\caption{$t$-small-divisor counts for wheel centers: twin vs non-twin.}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m4/m4_scatter_runlen_vs_tdiv.png}
\caption{Scatter of diagonal run length vs $t$-divisor count (twins highlighted).}
\end{figure}

\begin{table}[h]
\centering
\begin{tabular}{lcc}
\hline
Feature & Twin (mean/median) & Non-twin (mean/median) \\
\hline
diag\_run\_len\_K & 12.33 / 12 & 12.27 / 12 \\
t\_small\_div\_count & 5.40 / 4 & 5.37 / 4 \\
\hline
\end{tabular}
\caption{Summary stats for wheel overlay features at $m=12$, $K=120$.}
\end{table}

\section{M5 Twin signal on the $t$-axis}
We analyze the twin indicator $x_t$ along the $t$-axis for fixed wheel $B=L_m$,
looking for periodic structure beyond the DC component. We report FFT power,
autocorrelation, and modular lifts across residue classes.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m5/fft_power.png}
\caption{FFT power of the centered twin indicator $x_t-\bar{x}$.}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m5/autocorr.png}
\caption{Autocorrelation of the twin indicator (lags up to 5000).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m5/mod_m420_lift.png}
\caption{Residue-class lift for $m=420$ (relative to global twin rate).}
\end{figure}

\begin{table}[h]
\centering
\begin{tabular}{lccc}
\hline
Peak & $f_{\mathrm{idx}}$ & period $\approx T/f_{\mathrm{idx}}$ & perm-$p$ \\
\hline
1 & 30769 & 6.50 & 0.000 \\
2 & 92308 & 2.17 & 0.000 \\
3 & 82353 & 2.43 & 0.000 \\
4 & 94737 & 2.11 & 0.000 \\
5 & 76923 & 2.60 & 0.000 \\
\hline
\end{tabular}
\caption{Top FFT peaks (from $T=200000$). Periods are approximate; perm-$p$ uses shuffled controls.}
\end{table}

\paragraph{Autocorr and modular lifts.}
Top autocorrelation lags cluster around $\ell\in\{663, 741, \dots\}$ with small magnitude
($\approx 0.02$), and modular lifts show mild non-uniformity (e.g.\ $m=420$).
These signals are structured but not strongly separating at this resolution.

\section{M6 Wheel-shift control (m=10 vs m=12)}
We repeat the $t$-axis analysis with $m=10$ (wheel $B=L_{10}=2520$) at comparable $N_{\max}$
to test whether the dominant signatures shift to the smallest unfiltered prime (11).
Raw CSV for $m=10$ is stored compressed in \texttt{out/wheel\_scan\_m10\_t2200000.csv.gz}.

\begin{table}[h]
\centering
\begin{tabular}{lcc}
\hline
Wheel & top-lags divisible by $p$ & top-moduli divisible by $p$ \\
\hline
$m=10$ ($p=11$) & 18/20 & 16/20 \\
$m=12$ ($p=13$) & 18/20 & 17/20 \\
\hline
\end{tabular}
\caption{Divisibility of top autocorr lags and top chi2 moduli by the first unfiltered prime.}
\end{table}

\begin{table}[h]
\centering
\begin{tabular}{lcc}
\hline
Wheel & peak periods (approx.) & comment \\
\hline
$m=10$ & 11.0, 2.2, 2.75, 4.25 & harmonics of 11 \\
$m=12$ & 6.50, 2.17, 2.43, 2.60 & harmonics of 13/2 \\
\hline
\end{tabular}
\caption{FFT peak periods shift with the first unfiltered prime.}
\end{table}

\section{M7 Detrend and conditioning}
We detrend the twin indicator with a rolling mean and then condition on the
forbidden classes mod $p_0$ (removing the dominant wheel signature). Segment
analysis shows mild nonstationarity, so detrending is applied before spectral
comparisons. For m=10, conditional modulus scans are limited to $m\le 210$
for compute budget.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m7/m12/segment_rates.png}
\caption{Segmented twin rate (m=12, segment length 20k). Rates drift but remain stable at scale.}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m7/m12/detrend_fft_power_detrended.png}
\caption{Detrended FFT power (m=12). Dominant peaks reduce in amplitude after detrending.}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m7/m12/cond_p0_fft_power.png}
\caption{Conditional FFT after removing $p_0=13$ forbidden classes (m=12).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.98\linewidth]{../out/wave_atlas/m7/cond_fft_overlay_m10_m12.png}
\caption{Detrended vs conditioned spectra for m=10 and m=12. Conditioning removes the dominant $p_0$ ridge and leaves weaker structure.}
\end{figure}

\begin{table}[h]
\centering
\begin{tabular}{lcccc}
\hline
Wheel & rank & period & best fit & rel.\ err. \\
\hline
$m=10$ & 1 & 10.64 & $23/(2\cdot 1)$ & 0.081 \\
$m=10$ & 2 & 5.32 & $17/3$ & 0.066 \\
$m=10$ & 3 & 3.48 & $17/5$ & 0.022 \\
$m=12$ & 1 & 4.79 & $29/(2\cdot 3)$ & 0.008 \\
$m=12$ & 2 & 2.05 & $29/(2\cdot 7)$ & 0.008 \\
$m=12$ & 3 & 2.27 & $23/(2\cdot 5)$ & 0.012 \\
\hline
\end{tabular}
\caption{Top periods after conditioning ($p_0$ removed) with nearest harmonic fits to the next primes.}
\end{table}

\begin{table}[h]
\centering
\begin{tabular}{lcc}
\hline
Wheel & top-lags divisible by $p_0$ & top-moduli divisible by $p_0$ \\
\hline
$m=10$ ($p_0=11$) & 18/20 & 16/20 \\
$m=12$ ($p_0=13$) & 18/20 & 17/20 \\
\hline
\end{tabular}
\caption{Persistence of $p_0$ signature in M7; conditioning reduces but does not eliminate structure.}
\end{table}

\section{M8 Sequential conditioning}
We apply conditioning in layers: remove $p_0$, then $p_1$, then $p_2$, and track
the remaining spectral structure.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m8/m10/m8_fft_layers.png}
\caption{Sequential conditioning layers for m=10 (p0=11, p1=13, p2=17).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m8/m12/m8_fft_layers.png}
\caption{Sequential conditioning layers for m=12 (p0=13, p1=17, p2=19).}
\end{figure}

\begin{table}[h]
\centering
\begin{tabular}{lccc}
\hline
Wheel & layer & top period & fit \\
\hline
$m=10$ & 1 & 6.50 & $13/(2\cdot 1)$ \\
$m=10$ & 2 & 5.67 & $17/3$ \\
$m=10$ & 3 & 2.71 & $19/7$ \\
$m=12$ & 1 & 5.67 & $17/3$ \\
$m=12$ & 2 & 2.71 & $19/7$ \\
$m=12$ & 3 & 2.04 & $41/(2\cdot 10)$ \\
\hline
\end{tabular}
\caption{Top periods by layer after sequential conditioning (M8).}
\end{table}

Sequential conditioning removes successive modular combs induced by the first
non-wheel primes. Peak energy decays by orders of magnitude across layers, and
the remaining peaks align with the next prime layer rather than an independent
periodic mechanism.

\section{M9 Bridge to GT geometry}
We sample centers $c=B\cdot t$ from the wheel axis and compute GT core metrics
in the same $K$-window as the wave atlas. Core density varies by $t \bmod p_0$,
and conditioning on successive layers reshapes the distribution of GT metrics.
After controlling for layers, the global GC gap remains non-separating, while
local twin-row features stay strongly separated.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m9/m12/m9_core_edges_by_mod_p0.png}
\caption{Mean core\_edges by residue class $t \bmod p_0$ (m=12, $p_0=13$).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m9/m12/m9_layers_box_core_edges.png}
\caption{core\_edges distributions under layer conditioning (m=12).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m9/m12/m9_twin_non_twin_isolates.png}
\caption{Twin vs non-twin for local twin-row isolates (m=12).}
\end{figure}

\paragraph{M9b (wheel-lattice rows).}
To avoid degeneration at large centers, we compute core metrics on a wheel
row-lattice $n=B\cdot(t-r..t+r)$ with fixed $K$. This restores variability and
reveals residue-class structure.
Increasing $K$ from 120 to 240 raises variability (unique core\_edges 13$\to$19)
while preserving the same residue-class effects, indicating this bridge is not
a fragile $K$ artifact.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m9b/m12/K120/m9_core_edges_by_mod_p0.png}
\caption{Wheel-lattice core\_edges by $t \bmod p_0$ (m=12, K=120).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m9b/m12/K120/m9_layers_box_core_edges.png}
\caption{Wheel-lattice layer conditioning effects on core\_edges (m=12, K=120).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m9b/m12/K240/m9_core_edges_by_mod_p0.png}
\caption{Wheel-lattice core\_edges by $t \bmod p_0$ (m=12, K=240).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m9b/m12/K240/m9_layers_box_core_edges.png}
\caption{Wheel-lattice layer conditioning effects on core\_edges (m=12, K=240).}
\end{figure}

\appendix
\section{Roadmap / Future Work}
Planned milestones are listed in \texttt{docs/ROADMAP.md}. We summarize the
next steps as measurable deliverables (no claims of proof).

\begin{tabular}{lp{0.72\linewidth}}
\hline
M10 & Repro/CI polish: unified build command and stable PDF checksum. \\
M11 & Multi-wheel survey (m=8..14): energy decay by layers, p0 signatures. \\
M12 & Residual-as-process after 3 layers: gaps, ACF, goodness-of-fit. \\
M13 & GT wheel-lattice metrics: identify graph features sensitive to layers. \\
M14 & Candidate generator: layer-based acceleration and survival curves. \\
M15 & Mersenne wave atlas (optional): ord\_q(2) structure and conditioning. \\
M16 & Budget model: test-cost bridge for layered survival and throughput. \\
M17 & Two-stage budget model: cheap filter + expensive test. \\
M18 & Mersenne spectral density: rank exponents by resonance density. \\
M18b & Scaling/generalization of spectral density across $(Q_0,Q_1,p_{\max})$. \\
M19 & Weight tuning on spectral density (q- vs d-based weights). \\
M20b & Weight effects with all $p$: remove prime-mode degeneracy. \\
M21 & Hazard model for prime $p$ (death in $Q_1\setminus Q_0$). \\
M22 & Two-stage navigator for prime $p$ (M18 + M21 queue). \\
M23 & Budgeted search simulation (M18 vs M22 vs random). \\
M24 & Scale stress-test of M22 at larger $(p_{\max},Q_1)$ and big budgets. \\
M25 & Hard-mode stress-test: $Q_1$ up to 10M and strict Mersenne filters. \\
M26 & Calibrated survival predictor and extrapolation across Q. \\
M27 & Extrapolation stress-test beyond fit Q (10M $\rightarrow$ 20M/50M). \\
\hline
\end{tabular}

\section{M11 Multi-wheel survey}
We run the sequential conditioning pipeline for $m=8..14$ with fixed $t_{\max}=200000$.
The dominant layer follows the first prime $p_0>m$, and energy decays by orders
of magnitude across layers.

\begin{table}[h]
\centering
\scriptsize
\input{../out/wave_atlas/m11/m11_table.tex}
\caption{Multi-wheel summary (m=8..14). E1..E3 are top-peak energies after layers 1..3.}
\end{table}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m11/m11_energy_decay.png}
\caption{Energy decay by layer across wheels (m=8..14).}
\end{figure}

\section{M12 Residual-as-process}
After removing three sieve layers, we study the residual event process on the
allowed axis. The residual looks weakly structured, closer to noise than to a
strong periodic signal.
An inhomogeneous null model with local intensity $\hat p(i)$ explains part of
the overdispersion, but observed dispersion remains above the null band.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m12/m12_compare_dispersion.png}
\caption{Dispersion index (Var/Mean) of residual counts across m=10,12,14.}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m12/null/m12_dispersion_null_compare.png}
\caption{Observed dispersion vs inhomogeneous null (mean $\pm$ 90\% band).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m12/m12/residual_gaps.png}
\caption{Residual gap distribution for m=12 after three layers.}
\end{figure}

\section{M13 GT wheel-lattice metrics}
We evaluate additional graph metrics on wheel-lattice rows ($B=L_{12}$) to find
features that respond to sieve layers beyond core\_edges/gap/entropy.
We scan $(K,\varepsilon)\in\{120,240\}\times\{10^{-12},10^{-9},10^{-6}\}$ and
summarize sensitivity by residue class and layer conditioning.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m13/m13_best_metric_mean_by_mod_p0.png}
\caption{Best GT metric mean by $t \bmod p_0$ (M13).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m13/m13_best_metric_by_layer_box.png}
\caption{Best GT metric by layer conditioning (M13).}
\end{figure}

\begin{table}[h]
\centering
\input{../out/wave_atlas/m13/m13_top2_table.tex}
\caption{Top-2 GT metrics by sensitivity score (M13).}
\end{table}

\section{M14 Candidate generator (wave-sieve accelerator)}
We construct candidate centers by enforcing layered sieve constraints on $t$
and measure the practical survival rate and generation throughput as layers
increase. This provides a direct view of how modular filtering accelerates
the search space.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m14/m14_survival_vs_layers.png}
\caption{Survival rate versus number of sieve layers (M14).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m14/m14_throughput_vs_layers.png}
\caption{Candidate throughput versus number of sieve layers (M14).}
\end{figure}

\section{M14b Segmented layers (accelerator scaling)}
We avoid the exploding modulus $L=\prod p$ by applying the same layer filters
in fixed $t$ segments. This lets us extend to dozens of layers while keeping
runtime stable, and directly measure acceleration at large depth.
Each prime layer $p$ removes two forbidden phases in $t \bmod p$, so the
expected survival multiplier is $(1-2/p)$ under uniformity.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m14b/m14b_survival_vs_layers.png}
\caption{Segmented survival rate versus number of layers (M14b).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m14b/m14b_throughput_vs_layers.png}
\caption{Segmented throughput versus number of layers (M14b).}
\end{figure}

\begin{table}[h]
\centering
\input{../out/wave_atlas/m14b/m14b_efficiency_table.tex}
\caption{Efficiency summary across layers (M14b).}
\end{table}

Even small additional rejection can be worthwhile when candidate testing
dominates generation cost.

\section{M15 Mersenne wave atlas}
For Mersenne numbers, divisibility follows a pure order law:
$q \mid (2^p-1)$ iff $\mathrm{ord}_q(2)\mid p$.
We visualize the resulting $p\times q$ divisibility pattern and the histogram
of multiplicative orders. Filtering out small orders acts as a light
conditioning layer, revealing the residual structure.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m15/m15_divisibility_heatmap.png}
\caption{Mersenne divisibility heatmap (M15).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m15/m15_ord_hist.png}
\caption{Histogram of $\mathrm{ord}_q(2)$ for primes $q\le q_{\max}$ (M15).}
\end{figure}

\section{M16 Budget model (test-cost bridge)}
We connect layered survival to a realistic testing budget. Generation costs
remain in the microsecond range, while candidate testing costs span from
milliseconds to days. The total cost per raw candidate is
$c_g(L) + s(L)\,c_t$, so any additional rejection directly reduces
wall-clock time when $c_t$ dominates.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m16/m16_total_cost_vs_layers.png}
\caption{Total cost per raw candidate vs layers for different test costs (M16).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m16/m16_time_saved_vs_layers.png}
\caption{Time saved vs layers for $N_{\mathrm{raw}}=10^9$ candidates (M16).}
\end{figure}

\begin{table}[h]
\centering
\input{../out/wave_atlas/m16/m16_break_even_table.tex}
\caption{Break-even test cost thresholds by layer block (M16).}
\end{table}

Each step removes two phases modulo $p$, so the marginal survival drop scales
as $\approx 2/p$, but when test cost dominates, even small reductions translate
into real savings.

\begin{table}[h]
\centering
\input{../out/wave_atlas/m16/m16_savings_table.tex}
\caption{Illustrative time savings per $10^6$ raw candidates (M16).}
\end{table}

All time-saved values are aggregate compute-seconds; wallclock savings scale
by the number of parallel workers.
For example, 6$\to$150 corresponds to avoiding about 378{,}895 tests per $10^6$
raw candidates.

\section{M17 Two-stage budget model}
We extend the budget model to a two-stage pipeline: a cheap filter ($c_1$) with
pass rate $r_1$, followed by an expensive test ($c_2$). The expected per-raw
cost is $c_g(L) + s(L)\,(c_1 + r_1 c_2)$, and wallclock savings scale with
available workers.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m17/m17_total_cost_vs_layers.png}
\caption{Two-stage total cost per raw candidate vs layers (M17).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m17/m17_time_saved_vs_layers.png}
\caption{Two-stage time saved vs layers for $N_{\mathrm{raw}}=10^6$ (M17).}
\end{figure}

\begin{table}[h]
\centering
\input{../out/wave_atlas/m17/m17_break_even_table.tex}
\caption{Break-even thresholds for $c_2$ by layer block (M17).}
\end{table}

The marginal survival drop scales roughly as $2/p$, but when the expensive test
dominates, additional layers still yield direct savings.

\section{M18 Mersenne spectral density}
We rank exponents $p$ by a resonance density score built from small-prime
periods $d(q)=\mathrm{ord}_q(2)$. Scores are computed from a base set $Q_0$
and evaluated against a deeper $Q_1$, so enrichment reflects nontrivial
generalization beyond the training primes.
Because overall survival is already high, enrichment gains are bounded in
absolute terms even when ranking quality is strong.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m18/m18_density_heatmap.png}
\caption{Spectral kill density heatmap from top periods $d(q)$ (M18).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m18/m18_enrichment_curve.png}
\caption{Enrichment@k of survival in the quietest fraction of $p$ (M18).}
\end{figure}

\section{M18b Scaling and generalization}
We test the spectral density score across larger $p_{\max}$ and multiple
$(Q_0,Q_1)$ pairs to confirm that ranking quality persists beyond the
demonstration range.
As $p_{\max}$ grows with fixed $Q_1$, baseline survival rises and the ceiling
for enrichment necessarily drops.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m18b/m18b_auc_vs_pmax.png}
\caption{AUC vs $p_{\max}$ for multiple $(Q_0,Q_1)$ pairs (M18b).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m18b/m18b_enrichment_vs_pmax.png}
\caption{Enrichment@10\% vs $p_{\max}$ (M18b).}
\end{figure}

\section{M19 Weight tuning}
We compare weighting schemes for the resonance score, including weights by
prime size $q$ and by period $d(q)$, to maximize enrichment in the top slice.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m19/m19_enrichment_by_weight.png}
\caption{Enrichment@10\% by weight mode (M19).}
\end{figure}

\section{M20b Weight effects with all $p$}
The prime-only subset is degenerate because $\mathrm{ord}_q(2)\mid p$ implies
$\mathrm{ord}_q(2)=p$ for prime $p$, so positive weights cannot reorder
survivors. Using all $p$ (and examining composites separately) restores
multi-hit structure and reveals real weight effects.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m20b/m20b_auc_by_weight_composite.png}
\caption{AUC by weight mode on composite $p$ (M20b).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m20b/m20b_enrichment10_by_weight_composite.png}
\caption{Enrichment@10\% by weight mode on composite $p$ (M20b).}
\end{figure}

\clearpage
\section{M21 Hazard model for prime $p$}
We model the risk of later death among prime exponents that survived $Q_0$.
The target is $\text{death\_later}=\mathbf{1}[\mathrm{ord}_q(2)=p \text{ for some } q\le Q_1]$
within the set $Z=\{p:\text{killed}_{Q_0}=0\}$. Features use only arithmetic
pressure from $q\equiv 1 \ (\mathrm{mod}\ p)$ in $(Q_0,Q_1]$.
On $Z$, the optimal predictor is effectively binary: whether any $q\in(Q_0,Q_1]$
satisfies $q\equiv 1 \ (\mathrm{mod}\ p)$.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m21/m21_hazard_vs_death_bins.png}
\caption{Death\_later rate by hazard score bins (M21).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m21/m21_enrichment_curve.png}
\caption{Enrichment@k for death\_later on $Z$ (M21).}
\end{figure}

\section{M22 Two-stage Mersenne navigator}
We combine M18 and M21 into a single queue: early deaths (killed\_Q0) are
rejected or sent to the tail, and the remaining primes are sorted by hazard.
This yields a practical ordering of expensive tests.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m22/m22_enrichment_curve.png}
\caption{Survival enrichment vs tested fraction for the queue (M22).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m22/m22_tests_avoided.png}
\caption{Bad tests avoided vs tested fraction (M22).}
\end{figure}

\begin{table}[h]
\centering
\input{../out/wave_atlas/m22/m22_savings_table.tex}
\caption{Compute saved for top-k queue slices (M22).}
\end{table}

\section{M23 Budgeted search simulation}
We compare queue strategies under a fixed budget of expensive tests. For each
budget fraction, we measure the survival rate among selected primes and the
bad tests avoided versus random, then translate this into compute-seconds saved.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m23/m23_yield_vs_budget.png}
\caption{Survival yield vs budget for random, M18, M21, and M22 (M23).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m23/m23_compute_saved_vs_budget_3600.png}
\caption{Compute saved vs budget at test cost 1 hour (M23).}
\end{figure}

\begin{table}[h]
\centering
\input{../out/wave_atlas/m23/m23_table.tex}
\caption{Budgeted savings at selected budgets (M23).}
\end{table}

\clearpage
\section{M24 Scale stress-test}
\subsection{M24-A: $p_{\max}=200k$, $Q_0=50k$, $Q_1=500k$}
We stress-test M22 at larger ranges and extend budgets up to 50\% of prime $p$.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m24/p200k_Q0-50k_Q1-500k/m24_yield_vs_budget.png}
\caption{Yield vs budget (M24-A).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m24/p200k_Q0-50k_Q1-500k/m24_compute_saved_vs_budget_86400s.png}
\caption{Compute saved vs budget at 1 day test cost (M24-A).}
\end{figure}

\begin{table}[h]
\centering
\input{../out/wave_atlas/m24/p200k_Q0-50k_Q1-500k/m24_table.tex}
\caption{Selected budgets and savings (M24-A).}
\end{table}

\clearpage
\subsection{M24-B: $p_{\max}=200k$, $Q_0=100k$, $Q_1=1M$}
We repeat the stress-test with deeper $Q_0/Q_1$ to probe stability under heavier
screening by small primes.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m24/p200k_Q0-100k_Q1-1M/m24_yield_vs_budget.png}
\caption{Yield vs budget (M24-B).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m24/p200k_Q0-100k_Q1-1M/m24_compute_saved_vs_budget_86400s.png}
\caption{Compute saved vs budget at 1 day test cost (M24-B).}
\end{figure}

\begin{table}[h]
\centering
\input{../out/wave_atlas/m24/p200k_Q0-100k_Q1-1M/m24_table.tex}
\caption{Selected budgets and savings (M24-B).}
\end{table}

\clearpage
\subsection{M24-C: baseline ($p_{\max}=100k$, $Q_0=50k$, $Q_1=200k$)}
\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m24/p100k_Q0-50k_Q1-200k/m24_yield_vs_budget.png}
\caption{Yield vs budget (M24-C).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m24/p100k_Q0-50k_Q1-200k/m24_compute_saved_vs_budget_86400s.png}
\caption{Compute saved vs budget at 1 day test cost (M24-C).}
\end{figure}

\begin{table}[h]
\centering
\input{../out/wave_atlas/m24/p100k_Q0-50k_Q1-200k/m24_table.tex}
\caption{Selected budgets and savings (M24-C).}
\end{table}

\clearpage
\section{M25 Hard-mode stress-test}
\subsection{M25-A: $p_{\max}=200k$, $Q_0=100k$, $Q_1=10M$ (strict)}
We enforce stricter Mersenne-compatible filters ($q \bmod 8\in\{1,7\}$ and
$q\equiv 1 \pmod{2p}$ in hazard features) and extend $Q_1$ to 10M.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m25/p200k_Q0-100k_Q1-10M_strict/m25_yield_vs_budget.png}
\caption{Yield vs budget (M25-A).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m25/p200k_Q0-100k_Q1-10M_strict/m25_compute_saved_vs_budget_1d.png}
\caption{Compute saved vs budget at 1 day test cost (M25-A).}
\end{figure}

\begin{table}[h]
\centering
\input{../out/wave_atlas/m25/p200k_Q0-100k_Q1-10M_strict/m25_table.tex}
\caption{Selected budgets and savings (M25-A).}
\end{table}

\clearpage
\subsection{M25-B: $p_{\max}=300k$, $Q_0=150k$, $Q_1=10M$ (strict)}
\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m25/p300k_Q0-150k_Q1-10M_strict/m25_yield_vs_budget.png}
\caption{Yield vs budget (M25-B).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m25/p300k_Q0-150k_Q1-10M_strict/m25_compute_saved_vs_budget_1d.png}
\caption{Compute saved vs budget at 1 day test cost (M25-B).}
\end{figure}

\begin{table}[h]
\centering
\input{../out/wave_atlas/m25/p300k_Q0-150k_Q1-10M_strict/m25_table.tex}
\caption{Selected budgets and savings (M25-B).}
\end{table}

\begin{table}[h]
\centering
\input{../out/wave_atlas/m25/m25_key_table.tex}
\caption{Key yields and savings at 10\% and 50\% budgets (M25-A/B).}
\end{table}

\clearpage
\subsection{M25-C: baseline ($p_{\max}=200k$, $Q_0=100k$, $Q_1=1M$ strict)}
\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m25/p200k_Q0-100k_Q1-1M_strict/m25_yield_vs_budget.png}
\caption{Yield vs budget (M25-C).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m25/p200k_Q0-100k_Q1-1M_strict/m25_compute_saved_vs_budget_1d.png}
\caption{Compute saved vs budget at 1 day test cost (M25-C).}
\end{figure}

\begin{table}[h]
\centering
\input{../out/wave_atlas/m25/p200k_Q0-100k_Q1-1M_strict/m25_table.tex}
\caption{Selected budgets and savings (M25-C).}
\end{table}

\clearpage
\section{M26 Calibrated survival predictor}
We fit a calibrated survival predictor using hazard features and validate
calibration across $Q\in\{1M,2M,5M,10M\}$, then extrapolate expected yield
and compute savings without full Q1 labeling.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m26/p200k_Q0-100k_Qs-1-2-5-10M_strict/m26_calibration_fitQ.png}
\caption{Calibration at fit Q=10M (M26-A).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m26/p200k_Q0-100k_Qs-1-2-5-10M_strict/m26_predicted_yield_vs_budget.png}
\caption{Predicted yield vs budget from calibrated model (M26-A).}
\end{figure}

\begin{table}[h]
\centering
\input{../out/wave_atlas/m26/p200k_Q0-100k_Qs-1-2-5-10M_strict/m26_table.tex}
\caption{AUC/Brier/LogLoss across Q for calibrated model (M26-A).}
\end{table}

\clearpage
\section{M27 Extrapolation stress-test}
We test extrapolation by fitting the calibrated model at $Q=10$M and evaluating
at deeper Q, then compare against an upper-bound fit at $Q=20$M. We track
ranking stability (Spearman) and the extrapolation gap in AUC/Brier/LogLoss.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m27/p200k_Q0-100k_Qs-1-2-5-10-20-50M_strict/fit10M/m27_auc_by_Q.png}
\caption{AUC across Q for fit@10M (M27-A).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m27/p200k_Q0-100k_Qs-1-2-5-10-20-50M_strict/fit10M/m27_calibration_Q20000000.png}
\caption{Calibration at Q=20M for fit@10M (M27-A).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m27/p200k_Q0-100k_Qs-1-2-5-10-20-50M_strict/fit10M/m27_predicted_yield_vs_budget_Q20000000.png}
\caption{Predicted yield vs budget at Q=20M (M27-A).}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{../out/wave_atlas/m27/p200k_Q0-100k_Qs-1-2-5-10-20-50M_strict/fit10M/m27_rank_stability.png}
\caption{Rank stability across Q (M27-A).}
\end{figure}

\begin{table}[h]
\centering
\input{../out/wave_atlas/m27/p200k_Q0-100k_Qs-1-2-5-10-20-50M_strict/fit10M/m27_table.tex}
\caption{AUC/Brier/LogLoss across Q for fit@10M (M27-A).}
\end{table}

\clearpage
\end{document}
